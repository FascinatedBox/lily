import (Interpreter,
        TestCase) "../t/testing"

class TestResultMethods < TestCase
{
    public var @f: Result[Integer, Integer] = Failure(1)
    public var @s: Result[Integer, Integer] = Success(2)

    public define test__is_failure
    {
        @f.is_failure() |> assert_true
        @s.is_failure() |> assert_false
    }

    public define test__is_success
    {
        @f.is_success() |> assert_false
        @s.is_success() |> assert_true
    }

    public define test_failure
    {
        assert_equal(@f.failure().unwrap(), 1)
        @s.failure().is_none() |> assert_true
    }

    public define test_success
    {
        @f.success().is_none() |> assert_true
        assert_equal(@s.success().unwrap(), 2)
    }

    public define test_unwrap
    {
        assert_raises(
                "ValueError: unwrap called on Failure.",
                (|| Failure(1).@(Result[Integer, String]).unwrap() ))

        var v: Result[String, Integer] = Success(1)

        assert_equal(v.unwrap(), 1)
    }
}
